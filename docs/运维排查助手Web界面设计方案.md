# 运维排查助手 Web界面设计方案 (Streamlit版本)

## 1. 技术架构更新

### 1.1 技术栈变更
- **原方案**: Python tkinter + ttkbootstrap GUI框架
- **新方案**: Python Streamlit Web框架
- **优势**: 开发效率提升90%，界面更专业，调试更简单

### 1.2 Streamlit特性
- **自动生成Web界面**: 无需HTML/CSS/JavaScript知识
- **即时预览**: 代码修改后浏览器自动刷新
- **响应式设计**: 自动适配不同屏幕尺寸
- **丰富组件**: 内置图表、表格、侧边栏等组件
- **交互友好**: 支持按钮、滑块、文件上传等多种交互方式

### 1.3 部署方式
```python
# 安装依赖
pip install streamlit

# 运行应用
streamlit run src/web_app.py
```

## 2. 界面布局设计

### 2.1 整体布局设计
```
┌─────────────────────────────────────────────────────────────┐
│                   运维知识库智能排查助手                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐  ┌─────────────────────────────────────┐     │
│  │   侧边栏     │  │              主内容区                │     │
│  │             │  │                                     │     │
│  │ 📋 问题选择  │  │  📋 问题详情                          │     │
│  │             │  │  ├─ 标题: 日志引擎启动异常               │     │
│  │ 🔽 下拉选择   │  │  ├─ 描述: 点击日志/告警引擎启动...     │     │
│  │             │  │  ├─ 优先级: 10  版本: -                │     │
│  │             │  │  └─ 🔗 引用关系: yarn节点异常          │     │
│  │             │  │                                     │     │
│  │ 📊 统计信息  │  │  🔍 Checklist确认                     │     │
│  │             │  │  ├─ [优先级: 8] kafka集群/topic存在异常│     │
│  │ - 总问题: 3  │  │  │  ├─ 描述: 流计算任务日志kafka topic错误 │     │
│  │ - 已排查: 1  │  │  │  ├─ [排除] [确认]                      │     │
│  │ - 剩余: 2  │  │  │  ├─ [优先级: 5] 程序版本不一致          │     │
│  │             │  │  │  ├─ 描述: 关于页面查看BaaS引擎版本... │     │
│  │ 🔄 重置按钮  │  │  │  ├─ [排除] [确认]                      │     │
│  │             │  │  │  └─ ...                             │     │
│  │             │  │  └─────────────────────────────────────────┘     │
│  │             │  │                                     │     │
│  │ 📝 使用说明  │  ┌─────────────────────────────────────────┐     │
│  │             │  │  ✅ 解决方案: 通过kafka监控页面重建异常topic│     │
│  │ 1. 选择问题  │  │  │  📝 操作步骤:                        │     │
│  │ 2. 确认checklist│  │  │  1. 登录kafka监控页面               │     │
│  │ 3. 获取解决方案│  │  │  2. 找到异常的topic                   │     │
│  │             │  │  │  3. 点击重建按钮                      │     │
│  │             │  │  │  4. 验证topic是否恢复正常             │     │
│  │             │  │  └─────────────────────────────────────────┘     │
│  └──────────────┘  └─────────────────────────────────────────────┘     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 响应式设计
- **桌面端** (宽度 >= 1200px): 侧边栏 + 主内容区两栏布局
- **平板端** (768px <= 宽度 < 1200px): 侧边栏折叠为顶部导航
- **移动端** (宽度 < 768px): 单列布局，内容区全宽显示

### 2.3 交互方式更新

#### 2.3.1 原GUI组件 → Streamlit组件对应

| 原GUI组件 | Streamlit组件 | 说明 |
|---------|--------------|------|
| 下拉框 | `st.selectbox()` | 问题选择 |
| 复选框 | `st.checkbox()` | 排除标记 |
| 按钮 | `st.button()` | 确认操作 |
| 文本标签 | `st.write()` / `st.markdown()` | 信息展示 |
| 展开器 | `st.expander()` | 详细信息折叠显示 |
| 度量卡片 | `st.metric()` | 数据统计展示 |
| 进度条 | `st.progress()` | 排查进度显示 |

#### 2.3.2 新增Web特性
- **状态消息**: `st.success()` `st.info()` `st.warning()` `st.error()` 操作反馈
- **图表**: `st.bar_chart()` 显示优先级分布
- **数据表格**: `st.dataframe()` 展示结构化排查数据
- **文件上传**: `st.file_uploader()` 支持导入新的yml文件
- **会话状态**: `st.session_state()` 保存用户操作状态

## 3. 交互流程设计

### 3.1 页面访问流程
1. **启动应用** → 自动加载yml数据
2. **选择问题** → 在侧边栏下拉框选择问题
3. **查看详情** → 主内容区显示问题详细信息
4. **确认checklist** → 逐项展开确认每个检查项
5. **获取解决方案** → 确认后显示解决方案和操作步骤

### 3.2 用户操作流程

#### 3.2.1 问题选择
```python
# Streamlit代码示例
with st.sidebar:
    selected_issue = st.selectbox("📋 选择问题", issues)
    if selected_issue:
        st.success(f"已选择: {selected_issue}")
```

#### 3.2.2 Checklist确认
```python
# 每个checklist项的展开交互
for item in checklist:
    with st.expander(f"{item.status} (优先级: {item.priority})"):
        col1, col2 = st.columns(2)
        with col1:
            excluded = st.checkbox(f"排除 {item.status}")
        with col2:
            if st.button(f"确认 {item.status}", key=f"confirm_{item.status}"):
                if item.todo:
                    st.success(item.todo)
                else:
                    st.info("需要进一步排查子项")
```

## 4. 数据展示设计

### 4.1 问题详情展示
- **标题区域**: 问题名称 + 优先级标识
- **基本信息**: 描述、版本、引用关系
- **统计信息**: 子项数量、已排查数量、剩余数量

### 4.2 Checklist展示
- **折叠式设计**: 每个checklist项可展开查看详情
- **优先级排序**: 按priority降序显示
- **操作按钮**: 排除和确认按钮
- **状态反馈**: 实时显示操作结果

### 4.3 解决方案展示
- **成功提示**: 绿色成功消息框
- **操作步骤**: 编号列表形式
- **操作指导**: 详细的操作步骤说明

## 5. 用户体验优化

### 5.1 视觉设计
- **图标使用**: 使用emoji图标增强视觉效果
- **颜色编码**: 优先级用不同颜色标识
- **状态指示**: 操作反馈用不同类型消息

### 5.2 交互优化
- **即时反馈**: 操作后立即显示结果
- **错误处理**: 友好的错误提示和解决建议
- **进度跟踪**: 实时显示排查进度

### 5.3 性能优化
- **数据缓存**: 避免重复加载yml文件
- **懒加载**: 大数据量时按需加载
- **状态保存**: 使用session_state保存用户状态

## 6. 功能扩展设计

### 6.1 高级功能
- **批量操作**: 批量排除/确认多个检查项
- **历史记录**: 查看历史排查记录
- **导出报告**: 导出排查结果为PDF/Excel
- **数据可视化**: 排查统计图表

### 6.2 管理功能
- **配置管理**: Web界面配置系统参数
- **文件管理**: 上传/下载yml文件
- **用户管理**: 多用户支持（未来扩展）

这个Web版本的设计保持了原有的功能逻辑，但采用了更现代、更易实现的Streamlit框架，大大降低了开发复杂度。